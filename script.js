// ================================
// TRADUCTOR (ESPAÑOL/INGLÉS) - COMPLETO Y CORREGIDO
// ================================

const translations = {
  'es': {
    'brand': 'MI PORTAFOLIO',
    'menu-sobre': 'Sobre mí',
    'menu-habilidades': 'Habilidades',
    'menu-proyectos': 'Proyectos',
    'menu-testimonios': 'Testimonios',
    'menu-intereses': 'Intereses',
    'menu-contacto': 'Contacto',
    'hero-hola': '¡Hola! Soy Gabriela Lissette Amaya Garay',
    'hero-interes-titulo': 'Áreas de interés:',
    'hero-interes': '"Desarrollo Backend y Desarrollo de Apps Móviles"',
    'sobre-titulo': 'Sobre mí',
    'sobre-texto': 'Soy una persona responsable, puntual, con muchas ganas de progresar, aprendo rápido, capaz de trabajar en equipo. Mi objetivo en la empresa es demostrar mis conocimientos ayudando al funcionamiento de la misma y a su vez adquirir nuevas experiencias para seguir formándome tanto personal como laboral.',
    'btn-descargar': 'Descargar CV',
    'habilidades-titulo': 'Habilidades',
    'habilidades-blandas': 'Habilidades Blandas',
    'habilidades-duras': 'Habilidades Duras',
    'lenguajes-titulo': 'Lenguajes de Programación',
    'hab-trabajo': 'Trabajo en equipo',
    'hab-trabajo-desc': 'Capacidad para colaborar de manera efectiva con diferentes personas, aportando ideas y escuchando a los demás.',
    'hab-tiempo': 'Gestión del tiempo',
    'hab-tiempo-desc': 'Organización y priorización de tareas para cumplir plazos de forma eficiente y sin perder calidad.',
    'hab-aprendizaje': 'Aprendizaje continuo',
    'hab-aprendizaje-desc': 'Interés constante por adquirir nuevas habilidades y actualizar conocimientos en el área profesional.',
    'hab-responsabilidad': 'Responsabilidad',
    'hab-responsabilidad-desc': 'Compromiso con los objetivos y cumplimiento de las tareas asignadas con seriedad y disciplina.',
    'hab-creatividad': 'Creatividad',
    'hab-creatividad-desc': 'Capacidad para generar ideas innovadoras y proponer soluciones originales a los problemas.',
    'hab-git': 'Manejo de Git',
    'hab-git-desc': 'Uso de comandos principales para control de versiones, trabajo en ramas y colaboración en proyectos.',
    'hab-android': 'Uso de Android Studio',
    'hab-android-desc': 'Experiencia en la creación de aplicaciones móviles con Java y XML, incluyendo diseño de interfaces.',
    'hab-planillas': 'Elaboración de planillas de pago',
    'hab-planillas-desc': 'Realización de planillas de pago con cálculo de comisiones, IVA, ISSS, AFP y renta.',
    'hab-contabilidad': 'Registro y contabilización de transacciones financieras',
    'hab-contabilidad-desc': 'Capacidad para registrar y clasificar operaciones en comprobantes contables (ingresos, egresos, compras y ventas).',
    'proyectos-titulo': 'PROYECTOS',
    'proyecto1-titulo': 'Adopta a un amigo',
    'proyecto1-desc': 'Plataforma web para un refugio de animales, enfocada en promover la adopción responsable de mascotas.',
    'proyecto2-titulo': 'Task Planner',
    'proyecto2-desc': 'Aplicación móvil para organizar tareas, con almacenamiento local y filtros para una mejor gestión del tiempo.',
    'proyecto3-titulo': 'Artesanías Conchita',
    'proyecto3-desc': 'Prototipo de software empresarial que permite llevar el control completo de facturación e inventario de la empresa.',
    'proyecto4-titulo': 'Sitio web de Artesanías Conchita',
    'proyecto4-desc': 'Sitio web informativo que muestra los productos de la empresa',
    'ver-github': 'VER EN GITHUB',
    'ver-mas': 'Ver más',
    'testimonios-titulo': 'Testimonios',
    'testimonio1': '"Trabaja con responsabilidad y mantiene una actitud positiva."',
    'testimonio2': '"Muy responsable y cumplida, siempre entrega sus tareas a tiempo."',
    'intereses-titulo': 'Intereses',
    'interes1-titulo': 'Desarrollo Móvil',
    'interes1-desc': 'Me interesa crear aplicaciones móviles eficientes con Android Studio y explorar nuevas tecnologías móviles.',
    'interes2-titulo': 'Manga',
    'interes2-desc': 'Disfruto leer novelas ficticias.',
    'interes3-titulo': 'Música',
    'interes3-desc': 'Me apasiona escuchar y descubrir géneros musicales diversos, lo que me inspira en la creatividad.',
    'interes4-titulo': 'Fútbol',
    'interes4-desc': 'El deporte que más disfruto practicar y seguir, fomenta el trabajo en equipo y la disciplina.',
    'contacto-titulo': 'Contacto',
    'footer': '© 2025 Gabriela Amaya - Todos los derechos reservados',
    'marca-titulo': 'Marca Personal',
    'frase-marca': '“Con lealtad en el camino, constancia en el esfuerzo y pasión en cada aprendizaje, porque aprender juntos siempre nos lleva más lejos.”',
    
    // TRADUCCIONES NUEVAS PARA EL MODAL - COMPLETAS
    'description': 'Descripción',
    'features': 'Características',
    'technologies-used': 'Tecnologías Utilizadas',
    'programming-languages': 'Lenguajes de Programación',
    'applications': 'Aplicaciones',
    'role-performed': 'Rol Desempeñado',
    'close': 'Cerrar',
    'role-backend': 'Desarrollador Backend',
    'tech-languages': 'Lenguajes de Programación',
    'tech-apps': 'Aplicaciones',
    'image': 'Imagen'
  },
  'en': {
    'brand': 'MY PORTFOLIO',
    'menu-sobre': 'About me',
    'menu-habilidades': 'Skills',
    'menu-proyectos': 'Projects',
    'menu-testimonios': 'Testimonials',
    'menu-intereses': 'Interests',
    'menu-contacto': 'Contact',
    'hero-hola': 'Hello! I am Gabriela Lissette Amaya Garay',
    'hero-interes-titulo': 'Areas of interest:',
    'hero-interes': '"Backend Development and Mobile App Development"',
    'sobre-titulo': 'About me',
    'sobre-texto': 'I am a responsible, punctual person with a strong desire to progress, I learn quickly, and I am capable of working in a team. My goal in the company is to demonstrate my knowledge by helping its operation. At the same time, I want to acquire new experiences to continue developing both personally and professionally.',
    'btn-descargar': 'Download CV',
    'habilidades-titulo': 'Skills',
    'habilidades-blandas': 'Soft Skills',
    'habilidades-duras': 'Hard Skills',
    'lenguajes-titulo': 'Programming Languages',
    'hab-trabajo': 'Teamwork',
    'hab-trabajo-desc': 'Ability to collaborate effectively with different people, contributing ideas and listening to others.',
    'hab-tiempo': 'Time management',
    'hab-tiempo-desc': 'Organization and prioritization of tasks to meet deadlines efficiently without losing quality.',
    'hab-aprendizaje': 'Continuous learning',
    'hab-aprendizaje-desc': 'Constant interest in acquiring new skills and updating knowledge in the professional field.',
    'hab-responsabilidad': 'Responsibility',
    'hab-responsabilidad-desc': 'Commitment to objectives and fulfillment of assigned tasks with seriousness and discipline.',
    'hab-creatividad': 'Creativity',
    'hab-creatividad-desc': 'Ability to generate innovative ideas and propose original solutions to problems.',
    'hab-git': 'Git Management',
    'hab-git-desc': 'Use of main commands for version control, branch work and project collaboration.',
    'hab-android': 'Android Studio Usage',
    'hab-android-desc': 'Experience in creating mobile applications with Java and XML, including interface design.',
    'hab-planillas': 'Payroll preparation',
    'hab-planillas-desc': 'Preparation of payrolls with calculation of commissions, VAT, ISSS, AFP and income tax.',
    'hab-contabilidad': 'Recording and accounting of financial transactions',
    'hab-contabilidad-desc': 'Ability to record and classify operations in accounting vouchers (income, expenses, purchases and sales).',
    'proyectos-titulo': 'PROJECTS',
    'proyecto1-titulo': 'Adopt a friend',
    'proyecto1-desc': 'Web platform for an animal shelter, focused on promoting responsible pet adoption.',
    'proyecto2-titulo': 'Task Planner',
    'proyecto2-desc': 'Mobile application to organize tasks, with local storage and filters for better time management.',
    'proyecto3-titulo': 'Conchita Crafts',
    'proyecto3-desc': 'Business software prototype that allows complete control of company billing and inventory.',
    'proyecto4-titulo': 'Conchita Crafts Website',
    'proyecto4-desc': 'Informative website that displays the company products',
    'ver-github': 'VIEW ON GITHUB',
    'ver-mas': 'View more',
    'testimonios-titulo': 'Testimonials',
    'testimonio1': '"Works with responsibility and maintains a positive attitude."',
    'testimonio2': '"Very responsible and diligent, always delivers her tasks on time."',
    'intereses-titulo': 'Interests',
    'interes1-titulo': 'Mobile Development',
    'interes1-desc': 'I am interested in creating efficient mobile applications with Android Studio and exploring new mobile technologies.',
    'interes2-titulo': 'Manga',
    'interes2-desc': 'I enjoy reading fictional novels.',
    'interes3-titulo': 'Music',
    'interes3-desc': 'I am passionate about listening to and discovering diverse music genres, which inspires my creativity.',
    'interes4-titulo': 'Soccer',
    'interes4-desc': 'The sport I most enjoy practicing and following, promotes teamwork and discipline.',
    'contacto-titulo': 'Contact',
    'footer': '© 2025 Gabriela Amaya - All rights reserved',
    'marca-titulo': 'Personal Brand',
    'frase-marca': '“With loyalty along the way, perseverance in effort, and passion in every learning process, because learning together always takes us further.”',
    
    
    // TRADUCCIONES NUEVAS PARA EL MODAL - COMPLETAS
    'description': 'Description',
    'features': 'Features',
    'technologies-used': 'Technologies Used',
    'programming-languages': 'Programming Languages',
    'applications': 'Applications',
    'role-performed': 'Role Performed',
    'close': 'Close',
    'role-backend': 'Backend Developer',
    'tech-languages': 'Programming Languages',
    'tech-apps': 'Applications',
    'image': 'Image'
  }
};

let currentLang = 'es';

function changeLanguage(lang) {
  currentLang = lang;
  const elements = document.querySelectorAll('[data-lang]');

  elements.forEach(element => {
    const key = element.getAttribute('data-lang');
    if (translations[lang] && translations[lang][key]) {
      element.textContent = translations[lang][key];
    }
  });

  // Actualizar etiqueta de idioma
  const langLabel = document.getElementById('lang-label');
  if (langLabel) {
    langLabel.textContent = lang === 'es' ? 'Español' : 'English';
  }

  // Si hay un modal abierto, actualizar su contenido
  if (modal && modal.style.display === 'block') {
    const activeProject = getActiveProject();
    if (activeProject) {
      updateProjectModal(activeProject);
    }
  }
}

// ================================
// MODO OSCURO/CLARO
// ================================

const toggleBtn = document.getElementById("mode-toggle");
const body = document.body;

if (toggleBtn) {
  // Verificar preferencia guardada (sin localStorage)
  const isDarkMode = true; // Por defecto modo oscuro

  if (!isDarkMode) {
    body.classList.add("light-mode");
    toggleBtn.textContent = "☀️";
  } else {
    body.classList.remove("light-mode");
    toggleBtn.textContent = "🌙";
  }

  toggleBtn.addEventListener("click", () => {
    body.classList.toggle("light-mode");

    if (body.classList.contains("light-mode")) {
      toggleBtn.textContent = "☀️";
    } else {
      toggleBtn.textContent = "🌙";
    }
  });
}

// ================================
// DATOS DE LOS PROYECTOS (TRADUCIDOS)
// ================================

const projectsData = {
    'adopta-amigo': {
        title: { 'es': 'Adopta a un amigo', 'en': 'Adopt a friend' },
        modalTitle: { 'es': 'Adopta a un amigo | 2024', 'en': 'Adopt a friend | 2024' },
        description: {
            'es': 'Plataforma web para un refugio de animales, enfocada en promover la adopción responsable de mascotas. Permite a los usuarios ver los animales disponibles, filtrar por características y solicitar adopciones de manera sencilla.',
            'en': 'Web platform for an animal shelter, focused on promoting responsible pet adoption. Allows users to view available animals, filter by characteristics, and request adoptions easily.'
        },
        features: {
            'es': [
                'Sistema de registro de usuarios',
                'Catálogo de animales disponibles para adopción',
                'Filtros por tipo, tamaño y edad del animal',
                'Formulario de solicitud de adopción',
                'Panel de administración para el refugio'
            ],
            'en': [
                'User registration system',
                'Catalog of animals available for adoption',
                'Filters by animal type, size and age',
                'Adoption request form',
                'Administration panel for the shelter'
            ]
        },
        technologies: [
                { name: 'C#', icon: 'fas fa-code', color: '#a179dc', type: 'language' },
                { name: 'ASP.NET', icon: 'fas fa-globe', color: '#512bd4', type: 'app' },
                { name: 'SQL Server', icon: 'fas fa-database', color: '#cc2927', type: 'app' },
                { name: 'Entity Framework', icon: 'fas fa-layer-group', color: '#004880', type: 'app' }

        ],
        role: { 'es': 'Desarrollador Backend', 'en': 'Backend Developer' },
        githubLink: 'https://github.com/gabrielaamaya/progral-2024-semi.git',
        images: [
            'Adoptaaunamigo.jpeg',
            'visual studio.png',
            'adopta un amigo-inicio.jpeg',
        ]
    },
    'task-planner': {
        title: { 'es': 'Task Planner', 'en': 'Task Planner' },
        modalTitle: { 'es': 'Task Planner | 2025', 'en': 'Task Planner | 2025' },
        description: {
            'es': 'Aplicación móvil para organizar tareas, con almacenamiento local y filtros para una mejor gestión del tiempo. Permite crear, editar y eliminar tareas, establecer prioridades y fechas de vencimiento.',
            'en': 'Mobile application to organize tasks, with local storage and filters for better time management. Allows creating, editing and deleting tasks, setting priorities and due dates.'
        },
        features: {
            'es': [
                'Creación y gestión de tareas con fecha y hora límite',
                'Sistema de repetición diaria de tareas',
                'Marcado de tareas como realizadas',
                'Visualización de gráficos de progreso',
                'Organización por grupos de tareas'
            ],
            'en': [
                'Task creation and management with due date and time',
                'Daily task repetition system',
                'Mark tasks as completed',
                'Progress charts visualization',
                'Organization by task groups'
            ]
        },
        technologies: [
            { name: 'Java', icon: 'fab fa-java', color: '#ed8b00', type: 'language' },
            { name: 'Android Studio', icon: 'fab fa-android', color: '#3ddc84', type: 'app' },
            { name: 'Couchbase', icon: 'fas fa-database', color: '#aa2c26', type: 'database' }
        ],
        role: { 'es': 'Desarrollador Backend', 'en': 'Backend Developer' },
        githubLink: 'https://github.com/gabrielaamaya/Prograll-Semi-2025.git',
        images: [
            'task planner.png',
            'task planner login.jpeg',
            'task planner pantalla principal.jpeg',
            'task planner grafica.jpeg',
            'notificaciones.jpeg'
        ]
    },
    'artesanias-conchita': {
        title: { 'es': 'Artesanías Conchita', 'en': 'Conchita Crafts' },
        modalTitle: { 'es': 'Artesanías Conchita | 2024', 'en': 'Conchita Crafts | 2024' },
        description: {
            'es': 'Prototipo de software empresarial que permite llevar el control completo de facturación e inventario de la empresa. Facilita la gestión de productos, clientes, proveedores y ventas.',
            'en': 'Business software prototype that allows complete control of company billing and inventory. Facilitates product, customer, supplier and sales management.'
        },
        features: {
            'es': [
                'Gestión de inventario y productos',
                'Control de ventas y facturación',
                'Registro de clientes y proveedores',
                
            ],
            'en': [
                'Inventory and product management',
                'Sales and billing control',
                'Customer and supplier registration',
                
            ]
        },
        technologies: [
                { name: 'C#', icon: 'fas fa-code', color: '#a179dc', type: 'language' },
                { name: 'ASP.NET', icon: 'fas fa-globe', color: '#512bd4', type: 'app' },
                { name: 'SQL Server', icon: 'fas fa-database', color: '#cc2927', type: 'app' },
                { name: 'Entity Framework', icon: 'fas fa-layer-group', color: '#004880', type: 'app' }
        ],
        role: { 'es': 'Desarrollador Backend', 'en': 'Backend Developer' },
        githubLink: 'https://github.com/gabrielaamaya/Artesanias-Conchitas.git',
        images: [
            'Prototipo de Artesanias Conchita.jpeg',
            'login-artesania.jpeg',
            'ayuda-artesania.jpeg'
        ]
    },
    'artesanias-web': {
        title: { 'es': 'Sitio web de Artesanías Conchita', 'en': 'Conchita Crafts Website' },
        modalTitle: { 'es': 'Sitio web de Artesanías Conchita | 2024', 'en': 'Conchita Crafts Website | 2024' },
        description: {
            'es': 'Sitio web informativo que muestra los productos de la empresa. Permite a los clients conocer la historia de la empresa, ver el catálogo de productos y contactar con la empresa.',
            'en': 'Informative website that displays the company products. Allows customers to learn about the company history, view the product catalog and contact the company.'
        },
        features: {
            'es': [
                'Página informativa de productos artesanales',
                'Diseño atractivo y profesional',
                'Información de contacto y correo',
                'Presentación de catálogo de productos'
            ],
            'en': [
                'Informative page for handicraft products',
                'Attractive and professional design',
                'Contact information and email',
                'Product catalog presentation'
            ]
        },
        technologies: [
            { name: 'Python', icon: 'fab fa-python', color: '#3776ab', type: 'language' },
            { name: 'HTML', icon: 'fab fa-html5', color: '#e34f26', type: 'frontend' },
            { name: 'CSS', icon: 'fab fa-css3-alt', color: '#1572b6', type: 'frontend' },
            { name: 'JavaScript', icon: 'fab fa-js-square', color: '#f7df1e', type: 'frontend' }
        ],
        role: { 'es': 'Desarrollador Backend', 'en': 'Backend Developer' },
        githubLink: 'https://github.com/gabrielaamaya/Artesanias-Conchita-sitio-web.git',
        images: [
            'Prototipo de Artesanias Conchita.jpeg',
            'sitio web conchita modo claro.jpeg',
            'sitio web conchita modo oscuro.jpeg'
        ]
    }
};

// ================================
// FUNCIÓN PARA ACTUALIZAR PROYECTOS EN EL MODAL - CORREGIDA
// ================================

function updateProjectModal(projectId) {
    const project = projectsData[projectId];
    
    if (!project || !modal) return;
    
    // Actualizar contenido del modal según el idioma actual
    // Usar modalTitle (con año) en lugar de title (sin año)
    modalTitle.textContent = project.modalTitle ? project.modalTitle[currentLang] : project.title[currentLang];
    modalDescription.textContent = project.description[currentLang];
    modalRole.textContent = project.role[currentLang];
    modalGitHubLink.href = project.githubLink;
    
    // Actualizar características según el idioma
    modalFeatures.innerHTML = '';
    project.features[currentLang].forEach(feature => {
        const li = document.createElement('li');
        li.textContent = feature;
        modalFeatures.appendChild(li);
    });
    
    // Actualizar tecnologías - Separar lenguajes y aplicaciones
    const modalTechLanguages = document.getElementById('modalTechLanguages');
    const modalTechApps = document.getElementById('modalTechApps');
    
    if (modalTechLanguages && modalTechApps) {
        modalTechLanguages.innerHTML = '';
        modalTechApps.innerHTML = '';
        
        // Actualizar subtítulos según el idioma
        const languagesSubtitle = document.querySelector('.tech-subtitle[data-lang="programming-languages"]');
        const appsSubtitle = document.querySelector('.tech-subtitle[data-lang="applications"]');
        
        if (languagesSubtitle) {
            languagesSubtitle.textContent = translations[currentLang]['programming-languages'];
        }
        if (appsSubtitle) {
            appsSubtitle.textContent = translations[currentLang]['applications'];
        }
        
        project.technologies.forEach(tech => {
            const techItem = document.createElement('div');
            techItem.className = 'tech-item';
            techItem.innerHTML = `
                <i class="${tech.icon}" style="color: ${tech.color};"></i>
                <span>${tech.name}</span>
            `;
            
            // Clasificar en lenguajes o aplicaciones
            if (tech.type === 'language') {
                modalTechLanguages.appendChild(techItem);
            } else {
                modalTechApps.appendChild(techItem);
            }
        });
    }
    
    // Actualizar galería de imágenes
    const galleryContainer = modalGallery.querySelector('.gallery-container');
    const indicatorsContainer = document.getElementById('galleryIndicators');
    
    if (galleryContainer && indicatorsContainer) {
        galleryContainer.innerHTML = '';
        indicatorsContainer.innerHTML = '';
        
        project.images.forEach((image, index) => {
            const img = document.createElement('img');
            img.src = image;
            img.alt = `${project.title[currentLang]} - ${translations[currentLang]['image']} ${index + 1}`;
            
            if (index === 0) {
                img.classList.add('active');
            } else if (index === 1) {
                img.classList.add('next');
            } else {
                img.classList.add('hidden');
            }
            
            galleryContainer.appendChild(img);
            
            const indicator = document.createElement('span');
            indicator.classList.add('indicator');
            if (index === 0) indicator.classList.add('active');
            indicator.onclick = () => goToImage(index);
            indicatorsContainer.appendChild(indicator);
        });
        
        galleryImages = galleryContainer.querySelectorAll('img');
        galleryIndicators = indicatorsContainer.querySelectorAll('.indicator');
        totalImages = project.images.length;
        currentIndex = 0;
    }
}

// ================================
// GALERÍA 3D - VARIABLES GLOBALES
// ================================

let currentIndex = 0;
let totalImages = 0;
let galleryImages = [];
let galleryIndicators = [];

// ================================
// FUNCIONES DE GALERÍA 3D
// ================================

function updateGallery() {
  galleryImages.forEach((img, index) => {
    img.classList.remove('active', 'prev', 'next', 'hidden');
    
    if (index === currentIndex) {
      img.classList.add('active');
    } else if (index === (currentIndex - 1 + totalImages) % totalImages) {
      img.classList.add('prev');
    } else if (index === (currentIndex + 1) % totalImages) {
      img.classList.add('next');
    } else {
      img.classList.add('hidden');
    }
  });
  
  galleryIndicators.forEach((ind, index) => {
    ind.classList.toggle('active', index === currentIndex);
  });
}

function nextImage() {
  currentIndex = (currentIndex + 1) % totalImages;
  updateGallery();
}

function prevImage() {
  currentIndex = (currentIndex - 1 + totalImages) % totalImages;
  updateGallery();
}

function goToImage(index) {
  currentIndex = index;
  updateGallery();
}

// ================================
// FUNCIONALIDAD DEL MODAL DE PROYECTOS
// ================================

let modal = null;
let modalTitle = null;
let modalDescription = null;
let modalFeatures = null;
let modalRole = null;
let modalGitHubLink = null;
let modalGallery = null;
let closeModalBtn = null;

// Función para obtener el proyecto activo
function getActiveProject() {
    const activeCard = document.querySelector('.card.active');
    return activeCard ? activeCard.getAttribute('data-project') : null;
}

// Función para abrir el modal
function openProjectModal(projectId) {
    // Marcar el proyecto como activo
    const cards = document.querySelectorAll('.card');
    cards.forEach(card => {
        card.classList.remove('active');
        if (card.getAttribute('data-project') === projectId) {
            card.classList.add('active');
        }
    });
    
    updateProjectModal(projectId);
    
    // Mostrar modal
    modal.style.display = 'block';
    document.body.style.overflow = 'hidden';
}

// Función para cerrar el modal
function closeProjectModal() {
    if (modal) {
        modal.style.display = 'none';
        document.body.style.overflow = 'auto';
        
        // Remover clase activa
        const activeCard = document.querySelector('.card.active');
        if (activeCard) {
            activeCard.classList.remove('active');
        }
    }
}

// ================================
// MODAL PARA VISUALIZACIÓN DE IMÁGENES EN GRANDE
// ================================

let imageModal = null;
let modalImage = null;
let modalCaption = null;
let currentImageIndex = 0;
let currentProjectImages = [];

// Inicializar modal de imágenes
function initImageModal() {
    // Crear elementos del modal si no existen
    if (!document.getElementById('imageModal')) {
        const modalHTML = `
            <div id="imageModal" class="image-modal">
                <div class="image-modal-content">
                    <span class="image-close">&times;</span>
                    <div class="image-modal-body">
                        <img id="modalImage" src="" alt="">
                        <div class="image-caption">
                            <span id="modalCaption"></span>
                            <span id="imageCounter"></span>
                        </div>
                    </div>
                    <button class="image-nav image-prev">&#10094;</button>
                    <button class="image-nav image-next">&#10095;</button>
                </div>
            </div>
        `;
        document.body.insertAdjacentHTML('beforeend', modalHTML);
    }

    imageModal = document.getElementById('imageModal');
    modalImage = document.getElementById('modalImage');
    modalCaption = document.getElementById('modalCaption');
    
    // Event listeners para el modal de imágenes
    document.querySelector('.image-close').addEventListener('click', closeImageModal);
    document.querySelector('.image-prev').addEventListener('click', showPrevImage);
    document.querySelector('.image-next').addEventListener('click', showNextImage);
    
    imageModal.addEventListener('click', function(e) {
        if (e.target === imageModal) {
            closeImageModal();
        }
    });
}

// Abrir modal de imagen
function openImageModal(imageSrc, caption, projectImages, startIndex = 0) {
    if (!imageModal) initImageModal();
    
    modalImage.src = imageSrc;
    modalCaption.textContent = caption;
    currentProjectImages = projectImages;
    currentImageIndex = startIndex;
    
    updateImageCounter();
    imageModal.style.display = 'block';
    document.body.style.overflow = 'hidden';
}

// Cerrar modal de imagen
function closeImageModal() {
    if (imageModal) {
        imageModal.style.display = 'none';
        document.body.style.overflow = 'auto';
        currentProjectImages = [];
        currentImageIndex = 0;
    }
}

// Mostrar imagen anterior
function showPrevImage() {
    if (currentProjectImages.length === 0) return;
    
    currentImageIndex = (currentImageIndex - 1 + currentProjectImages.length) % currentProjectImages.length;
    const project = getActiveProject();
    const projectData = projectsData[project];
    
    modalImage.src = currentProjectImages[currentImageIndex];
    modalCaption.textContent = `${projectData.title[currentLang]} - ${translations[currentLang]['image']} ${currentImageIndex + 1}`;
    updateImageCounter();
}

// Mostrar siguiente imagen
function showNextImage() {
    if (currentProjectImages.length === 0) return;
    
    currentImageIndex = (currentImageIndex + 1) % currentProjectImages.length;
    const project = getActiveProject();
    const projectData = projectsData[project];
    
    modalImage.src = currentProjectImages[currentImageIndex];
    modalCaption.textContent = `${projectData.title[currentLang]} - ${translations[currentLang]['image']} ${currentImageIndex + 1}`;
    updateImageCounter();
}

// Actualizar contador de imágenes
function updateImageCounter() {
    const imageCounter = document.getElementById('imageCounter');
    if (imageCounter && currentProjectImages.length > 0) {
        imageCounter.textContent = `${currentImageIndex + 1} / ${currentProjectImages.length}`;
    }
}

// Agregar event listeners a las imágenes de la galería
function initGalleryImageClicks() {
    document.addEventListener('click', function(e) {
        // Verificar si se hizo clic en una imagen de la galería
        const galleryImg = e.target.closest('.gallery-container img');
        if (galleryImg && modal && modal.style.display === 'block') {
            const galleryContainer = galleryImg.closest('.gallery-container');
            const images = Array.from(galleryContainer.querySelectorAll('img'));
            const imageIndex = images.indexOf(galleryImg);
            const project = getActiveProject();
            const projectData = projectsData[project];
            
            if (projectData && projectData.images) {
                openImageModal(
                    galleryImg.src,
                    `${projectData.title[currentLang]} - ${translations[currentLang]['image']} ${imageIndex + 1}`,
                    projectData.images,
                    imageIndex
                );
            }
        }
    });
}

// Función para ampliar imagen al hacer clic del logotipo 
function initImagenAmpliada() {
    const logoImg = document.querySelector('.logo-img');
    const overlay = document.createElement('div');
    overlay.className = 'overlay';
    document.body.appendChild(overlay);

    if (logoImg) {
        logoImg.addEventListener('click', function() {
            // Crear copia de la imagen para vista ampliada
            const imagenGrande = this.cloneNode();
            imagenGrande.className = 'imagen-grande';
            
            // Mostrar overlay
            overlay.style.display = 'block';
            
            // Agregar imagen ampliada al body
            document.body.appendChild(imagenGrande);
            
            // Funciones para cerrar
            function cerrarImagen() {
                if (document.body.contains(imagenGrande)) {
                    document.body.removeChild(imagenGrande);
                }
                overlay.style.display = 'none';
            }
            
            // Event listeners para cerrar
            imagenGrande.addEventListener('click', cerrarImagen);
            overlay.addEventListener('click', cerrarImagen);
            
            // Cerrar con tecla ESC
            document.addEventListener('keydown', function cerrarConTecla(e) {
                if (e.key === 'Escape') {
                    cerrarImagen();
                    document.removeEventListener('keydown', cerrarConTecla);
                }
            });
        });
    }
}

// Inicializar cuando el DOM esté listo
document.addEventListener('DOMContentLoaded', initImagenAmpliada);


// ================================
// INICIALIZACIÓN
// ================================

document.addEventListener('DOMContentLoaded', function() {
    // Inicializar elementos del DOM
    modal = document.getElementById('projectModal');
    modalTitle = document.getElementById('modalTitle');
    modalDescription = document.getElementById('modalDescription');
    modalFeatures = document.getElementById('modalFeatures');
    modalRole = document.getElementById('modalRole');
    modalGitHubLink = document.getElementById('modalGitHubLink');
    modalGallery = document.getElementById('modalGallery');
    closeModalBtn = document.querySelector('.close-modal');

    // Event listener para cerrar modal
    if (closeModalBtn) {
        closeModalBtn.addEventListener('click', closeProjectModal);
    }

    if (modal) {
        modal.addEventListener('click', function(e) {
            if (e.target === modal) {
                closeProjectModal();
            }
        });
    }

    // Event listeners para botones "Ver más"
    const verMasButtons = document.querySelectorAll('.btn-more');
    verMasButtons.forEach(button => {
        button.addEventListener('click', function(e) {
            e.preventDefault();
            const card = this.closest('.card');
            if (card) {
                const projectId = card.getAttribute('data-project');
                if (projectId) {
                    openProjectModal(projectId);
                }
            }
        });
    });

    // Botón de cambio de idioma
    const langToggle = document.getElementById('lang-toggle');
    if (langToggle) {
        langToggle.addEventListener('click', function() {
            const newLang = currentLang === 'es' ? 'en' : 'es';
            changeLanguage(newLang);
        });
    }

    // Event listeners para controles de galería
    const prevBtn = document.querySelector('.prev-btn');
    const nextBtn = document.querySelector('.next-btn');

    if (prevBtn) {
        prevBtn.addEventListener('click', prevImage);
    }

    if (nextBtn) {
        nextBtn.addEventListener('click', nextImage);
    }

    // Inicializar modal de imágenes
    initImageModal();
    
    // Inicializar clics en imágenes de galería
    initGalleryImageClicks();

    // Cerrar modal con tecla Escape
    document.addEventListener('keydown', function(e) {
        if (e.key === 'Escape') {
            if (imageModal && imageModal.style.display === 'block') {
                closeImageModal();
            } else if (modal && modal.style.display === 'block') {
                closeProjectModal();
            }
        }
    });

    // Inicializar traducciones
    changeLanguage('es');
});

// Función para scroll suave
function scrollToTop() {
  window.scrollTo({ top: 0, behavior: 'smooth' });
}